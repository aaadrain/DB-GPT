{"difficulty": "简单", "question": "员工的性别比例是多少?", "answer": "select 性别, count(性别) from a_sap_personnel_basic_information_ai_chinese_real group by 性别;"}
{"difficulty": "简单", "question": "哪个一级机构下员工最多?", "answer": "select 一级机构名称, count(一级机构名称) from a_sap_personnel_basic_information_ai_chinese_real group by 一级机构名称 order by count(一级机构名称) desc limit 1;"}
{"difficulty": "简单", "question": "哪个部门下员工最多?", "answer": "select 一级机构名称, count(一级机构名称) from a_sap_personnel_basic_information_ai_chinese_real group by 一级机构名称 order by count(一级机构名称) desc limit 1;"}
{"difficulty": "简单", "question": "当前公司有哪些职务的员工?", "answer": "select distinct 职务名称 from a_sap_personnel_basic_information_ai_chinese_real;"}
{"difficulty": "中等", "question": "哪个岗位的人员流动（离职和入职）最频繁?", "answer": "select 职位, count(职位) from a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态!='在职' group by 职位 order by count(职位) desc limit 1;"}
{"difficulty": "中等", "question": "持有本科学历的员工有多少人?", "answer": "select 学历, count(学历) from a_sap_employee_education_information_ai_chinese_real group by 学历 having 学历='[学历]';"}
{"difficulty": "中等", "question": "哪个一级机构的有效编制空缺最多?", "answer": "select 一级机构, sum(有效编制空缺) from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by sum(有效编制空缺) desc limit 1;"}
{"difficulty": "中等", "question": "哪个部门的有效编制空缺最多?", "answer": "select 一级机构, sum(有效编制空缺) from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by sum(有效编制空缺) desc limit 1;"}
{"difficulty": "中等", "question": "哪个部门的headcount空缺最多?", "answer": "select 一级机构, sum(有效编制空缺) from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by sum(有效编制空缺) desc limit 1;"}
{"difficulty": "困难", "question": "哪位员工的下属最多?", "answer": "select 直属上司姓名, count(直属上司姓名) from a_sap_personnel_basic_information_ai_chinese_real group by 直属上司姓名 order by count(直属上司姓名) desc limit 1;"}
{"difficulty": "困难", "question": "哪位员工在公司呆的时间最久?", "answer": "select 姓名, min(入职日期) from a_sap_personnel_basic_information_ai_chinese_real group by 姓名 order by min(入职日期) limit 1;"}
{"difficulty": "简单", "question": "公司今年第二季度的有效编制空缺数量是多少？", "answer": "select sum(有效编制空缺) from a_sap_et_zthr_zp_list_ai_chinese_real where 编制年度 = '2021' and 编制月度 in ('4', '5', '6');"}
{"difficulty": "中等", "question": "公司有多少位具有博士学历的员工？", "answer": "select count(人员工号) from a_sap_employee_education_information_ai_chinese_real where 学历 = '博士';"}
{"difficulty": "中等", "question": "公司员工中，哪位的在职时间最长？", "answer": "select 姓名, 入职日期 from a_sap_personnel_basic_information_ai_chinese_real order by 入职日期 limit 1;"}
{"difficulty": "中等", "question": "目前哪个职位的员工数量最多？", "answer": "select 职位, count(人员编号) as number from a_sap_personnel_basic_information_ai_chinese_real group by 职位 order by number desc limit 1;"}
{"difficulty": "困难", "question": "哪个一级机构的有效编制空缺数量最多？", "answer": "select 一级机构, sum(有效编制空缺) as number from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by number desc limit 1;"}
{"difficulty": "困难", "question": "哪个部门的HC空缺数量最多？", "answer": "select 一级机构, sum(有效编制空缺) as number from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by number desc limit 1;"}
{"difficulty": "困难", "question": "哪个部门的有效编制空缺数量最多？", "answer": "select 一级机构, sum(有效编制空缺) as number from a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构 order by number desc limit 1;"}
{"difficulty": "困难", "question": "哪个部门的部门负责人在岗时间最长？", "answer": "select 雇佣状态, 部门负责人, min(入职日期) as 在职时间 from a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态 = '在职' group by 雇佣状态, 部门负责人 order by 在职时间 limit 1;"}
{"difficulty": "困难", "question": "哪个员工的直属上司在职时间最短？", "answer": "select a.姓名, a.直属上司姓名, b.入职日期 from a_sap_personnel_basic_information_ai_chinese_real as a left join a_sap_personnel_basic_information_ai_chinese_real as b on a.直属上司姓名 = b.姓名 order by b.入职日期 desc limit 1;"}
{"difficulty": "困难", "question": "公司的员工中有多少位具有海外背景的员工（即学历信息中的国家不是中国）？", "answer": "select count(人员工号) from a_sap_employee_education_information_ai_chinese_real where 国家 != '中国' and 国家 != '中国香港' and 国家 != '中国澳门' and 国家 != '中国台湾' ;"}
{"difficulty": "困难", "question": "公司全职员工中,哪个岗位的员工平均工龄最大？", "answer": "select 职位, avg(date_part('year', age(cast(入职日期 as date)))) as avg_age from a_sap_personnel_basic_information_ai_chinese_real where 员工工作性质文本 = '全职-计算' group by 职位 order by avg_age desc limit 1;"}
{"difficulty": "简单", "question": "请问公司共有多少员工？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real;"}
{"difficulty": "简单", "question": "请问公司共有多少在职员工？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态 = '在职';"}
{"difficulty": "中等", "question": "公司的员工中有多少人拥有硕士以及以上学历？", "answer": "SELECT COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "困难", "question": "请列出公司各个职级范围的空缺职位数量？", "answer": "SELECT 职级范围, SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 职级范围;"}
{"difficulty": "简单", "question": "请问公司当前招聘编制使用情况与编制数量各是多少？", "answer": "SELECT 编制年度, 编制月度, 有效编制空缺, 年度编制数量, 季度编制数量, 月度编制数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real;"}
{"difficulty": "简单", "question": "请问工号为137109的员工的姓名和入职日期是什么？", "answer": "SELECT 姓名, 入职日期 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 人员编号 = '[工号]';"}
{"difficulty": "简单", "question": "请问算法工程师的职务和现职人数是什么？", "answer": "SELECT 职务, 现职人数 FROM public.a_sap_position_information_synchronization_ai_chinese_real WHERE 岗位名称 = '[岗位]';"}
{"difficulty": "中等", "question": "请问公司员工中的教育程度分布情况如何？", "answer": "SELECT 学历, COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real GROUP BY 学历;"}
{"difficulty": "中等", "question": "请问公司在T126的Q3的编制使用情况如何？", "answer": "SELECT * FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制月度 in  ([季度]) and 编制年度='[财年]';"}
{"difficulty": "中等", "question": "请问工号为137109员工的汇报关系是如何的？", "answer": "SELECT * FROM public.a_sap_reporting_relationship_ai_chinese_real WHERE 人员号 = '[工号]';"}
{"difficulty": "困难", "question": "请问公司各个一级机构的编制使用情况和现职人数分别是多少？", "answer": "select\n\taa. 一级机构,\n\tsum(cast(aa.有效编制空缺 as float)) as 有效编制空缺,\n\tsum(cast(aa.现职人数 as float)) as 现职人数\nfrom\n\t(\n\tselect\n\t\ta.一级机构,\n\t\ta.有效编制空缺,\n\t\tb.现职人数\n\tfrom\n\t\tpublic.a_sap_et_zthr_zp_list_ai_chinese_real a\n\tleft join public.a_sap_position_information_synchronization_ai_chinese_real b on\n\t\ta.一级机构 = b.一级机构\n\twhere\n\t\ta.编制月度 = '4'\n\t\tand a.编制年度 = 'T128'\n\t\t) aa\n\tgroup by\n\t\taa. 一级机构;"}
{"difficulty": "困难", "question": "请问公司各个部门的编制使用情况和现职人数分别是多少？", "answer": "select\n\taa. 一级机构,\n\tsum(cast(aa.有效编制空缺 as float)) as 有效编制空缺,\n\tsum(cast(aa.现职人数 as float)) as 现职人数\nfrom\n\t(\n\tselect\n\t\ta.一级机构,\n\t\ta.有效编制空缺,\n\t\tb.现职人数\n\tfrom\n\t\tpublic.a_sap_et_zthr_zp_list_ai_chinese_real a\n\tleft join public.a_sap_position_information_synchronization_ai_chinese_real b on\n\t\ta.一级机构 = b.一级机构\n\twhere\n\t\ta.编制月度 = '4'\n\t\tand a.编制年度 = 'T128'\n\t\t) aa\n\tgroup by\n\t\taa. 一级机构;"}
{"difficulty": "困难", "question": "请问公司中性别和学历分布的交叉情况如何？", "answer": "SELECT a.性别, b.学历, COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real a LEFT JOIN public.a_sap_employee_education_information_ai_chinese_real b ON a.人员编号 = b.人员工号 GROUP BY a.性别, b.学历;"}
{"difficulty": "简单", "question": "当前有多少员工具备硕士学历？", "answer": "SELECT COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历='硕士'"}
{"difficulty": "中等", "question": "最常见的教育类型是什么？", "answer": "SELECT 教育类型, COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real GROUP BY 教育类型 ORDER BY COUNT(*) DESC LIMIT 1"}
{"difficulty": "困难", "question": "哪些岗位的人员流动率最高？返回 TOP 5", "answer": "SELECT 职位, COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态='离职' GROUP BY 职位 ORDER BY COUNT(*) DESC limit 5"}
{"difficulty": "困难", "question": "从哪个学校毕业的员工最多？", "answer": "SELECT 院校_培训机构, COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real GROUP BY 院校_培训机构 ORDER BY COUNT(*) DESC LIMIT 1"}
{"difficulty": "困难", "question": "哪个一级机构的职位空缺最多？", "answer": "SELECT 一级机构, SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构 ORDER BY SUM(有效编制空缺) DESC LIMIT 1"}
{"difficulty": "困难", "question": "哪个部门的职位空缺最多？", "answer": "SELECT 一级机构, SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构 ORDER BY SUM(有效编制空缺) DESC LIMIT 1"}
{"difficulty": "困难", "question": "哪些职位的岗位职责最多？", "answer": "SELECT 职位, COUNT(岗位职责) FROM public.a_sap_position_information_synchronization_ai_chinese_real GROUP BY 职位 ORDER BY COUNT(岗位职责) DESC LIMIT 1"}
{"difficulty": "简单", "question": "查找到现在为止，公司一共有多少名员工？", "answer": "SELECT COUNT(人员编号) as total_employees FROM public.a_sap_personnel_basic_information_ai_chinese_real ;"}
{"difficulty": "简单", "question": "查找公司中男性员工的数量？", "answer": "SELECT COUNT(人员编号) as male_employees FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 性别 = '男';"}
{"difficulty": "中等", "question": "查找公司中拥有硕士学历的员工数量？", "answer": "SELECT COUNT(人员工号) as master_degree_count FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 = '硕士';"}
{"difficulty": "困难", "question": "查找在职期间完成博士学位的员工人数？", "answer": "SELECT COUNT(人员工号) as phd_count FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 = '博士' AND 开始日期 > 入职日期;"}
{"difficulty": "困难", "question": "查询哪个职位的在职人数最多？", "answer": "SELECT 职位, COUNT(人员编号) as employee_count FROM public.a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态='在职' GROUP BY 职位 ORDER BY employee_count DESC LIMIT 1;"}
{"difficulty": "困难", "question": "查询哪个一级机构的编制空缺最多？", "answer": "SELECT 一级机构, SUM(有效编制空缺) as total_vacancy FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构 ORDER BY total_vacancy DESC LIMIT 1;"}
{"difficulty": "简单", "question": "哪个部门的有效编制空缺数量最多？", "answer": "select 一级机构, 二级机构, 三级机构, sum(有效编制空缺) as 空缺数量 from public.a_sap_et_zthr_zp_list_ai_chinese_real group by 一级机构, 二级机构, 三级机构 order by 空缺数量 desc limit 1;"}
{"difficulty": "简单", "question": "哪个部门的人员数量最多？", "answer": "select 一级机构名称, 二级机构名称, 三级机构名称, count(*) as 人员数量 from public.a_sap_personnel_basic_information_ai_chinese_real group by 一级机构名称, 二级机构名称, 三级机构名称 order by 人员数量 desc limit 1;"}
{"difficulty": "简单", "question": "哪个部门的在职人员数量最多？", "answer": "select 一级机构名称, 二级机构名称, 三级机构名称, count(*) as 人员数量 from public.a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态='在职' group by 一级机构名称, 二级机构名称, 三级机构名称 order by 人员数量 desc limit 1;"}
{"difficulty": "困难", "question": "哪个岗位的人员拥有的专业类型最多？", "answer": "select 职位, count(distinct 第一专业) as 专业类型数 from public.a_sap_personnel_basic_information_ai_chinese_real left join public.a_sap_employee_education_information_ai_chinese_real on public.a_sap_personnel_basic_information_ai_chinese_real.人员编号 = public.a_sap_employee_education_information_ai_chinese_real.人员工号 group by 职位 order by 专业类型数 desc limit 1;"}
{"difficulty": "困难", "question": "哪位在职员工的直属下属数量最多？", "answer": "select 直属上司姓名, count(*) as 下属数量 from public.a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态 = '在职' group by 直属上司姓名 order by 下属数量 desc limit 1;"}
{"difficulty": "简单", "question": "今年的有效编制空缺数是多少？", "answer": "SELECT SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = 'T128';"}
{"difficulty": "简单", "question": "目前公司总共有多少在职员工？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "简单", "question": "当前有哪些部门负责人，他们分别负责什么一级机构？", "answer": "SELECT DISTINCT 部门负责人, 一级机构名称 FROM public.a_sap_personnel_basic_information_ai_chinese_real;"}
{"difficulty": "中等", "question": "公司各个一级机构下的在职员工数量分别是多少？按多到少排序", "answer": "SELECT 一级机构名称, COUNT(*) as 员工数 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职' and 一级机构名称 notnull GROUP BY 一级机构名称 order by 员工数 desc;"}
{"difficulty": "中等", "question": "哪些一级机构的有效编制空缺数超过10个？列出这些机构及其空缺数。", "answer": "SELECT 一级机构, SUM(有效编制空缺) as 空缺数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构 HAVING SUM(有效编制空缺) > 10;"}
{"difficulty": "中等", "question": "公司有多少员工拥有硕士及以上学位？", "answer": "SELECT COUNT(DISTINCT 人员工号) FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "困难", "question": "列出当前在职员工的平均工龄。", "answer": "SELECT AVG(EXTRACT(YEAR FROM CURRENT_DATE) - EXTRACT(YEAR FROM TO_DATE(入职日期, 'YYYY-MM-DD'))) as 平均工龄 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "困难", "question": "统计每个一级机构下，直属上司姓名为'张三'的员工所在的二级机构及员工数。", "answer": "SELECT 一级机构名称, 二级机构名称, COUNT(*) as 员工数 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 直属上司姓名 = '张三' GROUP BY 一级机构名称, 二级机构名称;"}
{"difficulty": "简单", "question": "公司目前的在职总员工数是多少？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "简单", "question": "哪个一级机构下的在职员工人数最多？", "answer": "SELECT 一级机构名称, COUNT(*) as 员工数 FROM public.a_sap_personnel_basic_information_ai_chinese_real where 雇佣状态='在职' GROUP BY 一级机构名称 ORDER BY 员工数 DESC LIMIT 1;"}
{"difficulty": "中等", "question": "目前持有硕士及以上学位的在职员工有多少？", "answer": "SELECT COUNT(DISTINCT e.人员工号) FROM public.a_sap_personnel_basic_information_ai_chinese_real p JOIN public.a_sap_employee_education_information_ai_chinese_real e ON p.人员编号 = e.人员工号 WHERE p.雇佣状态 = '在职' AND e.学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "困难", "question": "哪个职级范围的有效编制空缺数最多，以及该职级范围各一级机构下的空缺数分布情况是怎样的？", "answer": "WITH 编制空缺 AS (SELECT 职级范围, SUM(有效编制空缺) as 总空缺数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 职级范围), 最大空缺职级 AS (SELECT 职级范围 FROM 编制空缺 ORDER BY 总空缺数 DESC LIMIT 1) SELECT e.职级范围, e.一级机构, SUM(e.有效编制空缺) as 一级机构空缺数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real e JOIN 最大空缺职级 m ON e.职级范围 = m.职级范围 GROUP BY e.职级范围, e.一级机构;"}
{"difficulty": "简单", "question": "统计当前全部员工的平均入职年限。", "answer": "SELECT AVG(date_part('year', age(CAST(入职日期 AS DATE)))) as 平均入职年限 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "中等", "question": "查询员工中持有硕士及以上学位员工的数量占比。", "answer": "SELECT COUNT(*) FILTER (WHERE 学历 IN ('硕士', '博士')) * 100.0 / COUNT(*) as 高学位占比 FROM public.a_sap_employee_education_information_ai_chinese_real;"}
{"difficulty": "简单", "question": "计算当前年度的总编制数量是多少？", "answer": "SELECT SUM(CAST(年度编制数量 AS INT)) AS 总编制数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = 'T128'"}
{"difficulty": "中等", "question": "列出所有员工的最高学历以及对应的人数。", "answer": "SELECT 学历, COUNT(*) AS 人数 FROM public.a_sap_employee_education_information_ai_chinese_real GROUP BY 学历 ORDER BY 人数 DESC;"}
{"difficulty": "中等", "question": "查找在职员工中，哪个一级机构的员工数量最多？", "answer": "SELECT 一级机构名称, COUNT(*) AS 员工数量 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职' GROUP BY 一级机构名称 ORDER BY 员工数量 DESC LIMIT 1;"}
{"difficulty": "困难", "question": "找出所有具有管理角色（即是否管理机构为'是'）的员工名单和他们管理的二级机构和三级机构的数量。", "answer": "SELECT 姓名, COUNT(DISTINCT 二级机构) AS 管理的二级机构数量, COUNT(DISTINCT 三级机构) AS 管理的三级机构数量 FROM public.a_sap_reporting_relationship_ai_chinese_real WHERE 是否管理机构 = '是' GROUP BY 姓名;"}
{"difficulty": "简单", "question": "当前年度各一级机构的编制使用情况是怎样的？", "answer": "SELECT 一级机构, 编制年度, SUM(CAST(年度编制数量 AS INTEGER)) AS 总年度编制, SUM(CAST(有效编制空缺 AS INTEGER)) AS 总有效编制空缺 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构, 编制年度;"}
{"difficulty": "中等", "question": "公司中具有硕士学历及以上且目前在职的员工有多少？", "answer": "SELECT COUNT(DISTINCT p.人员编号) AS 硕士及以上学历在职员工数量 FROM public.a_sap_personnel_basic_information_ai_chinese_real p JOIN public.a_sap_employee_education_information_ai_chinese_real e ON p.人员编号 = e.人员工号 WHERE e.学历 IN ('硕士', '博士', '博士后') AND p.雇佣状态 = '在职';"}
{"difficulty": "困难", "question": "对于每个职位，当前有多少员工从事，并且他们的平均入职时长是多少（只计算在职员工）？", "answer": "SELECT b.职位, COUNT(p.人员编号) AS 在职员工数, AVG(DATE_PART('day', CURRENT_DATE::date) - DATE_PART('day', TO_DATE(p.入职日期, 'YYYY-MM-DD')::date)) / 365 AS 平均在职时长 FROM public.a_sap_personnel_basic_information_ai_chinese_real p INNER JOIN public.a_sap_position_information_synchronization_ai_chinese_real b ON p.职位 = b.职位 WHERE p.雇佣状态 = '在职' GROUP BY b.职位;"}
{"difficulty": "简单", "question": "请问目前的总在职人数是多少？", "answer": "SELECT COUNT(*) AS total_employees FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "简单", "question": "请问有哪些员工的学历是硕士及以上？", "answer": "SELECT 人员工号, 姓名, 学历 FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "中等", "question": "请问今年每个月的编制空缺数量和实际在职人数有什么变化？", "answer": "SELECT b.编制月度, b.有效编制空缺, (SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 入职日期 LIKE '2023%' AND 雇佣状态 = '在职') AS actual_employees FROM public.a_sap_et_zthr_zp_list_ai_chinese_real b WHERE b.编制年度 = '2023';"}
{"difficulty": "困难", "question": "请问每个一级机构内部的各个岗位平均入职年限是多少年，且按照从高到低排序？", "answer": "SELECT p.一级机构, p.职位, AVG(DATE_PART('year', CURRENT_DATE) - DATE_PART('year', TO_DATE(b.入职日期, 'YYYY-MM-DD'))) AS avg_years_of_service FROM public.a_sap_position_information_synchronization_ai_chinese_real p JOIN public.a_sap_personnel_basic_information_ai_chinese_real b ON p.职位 = b.职位 WHERE p.一级机构 IS NOT NULL AND b.入职日期 IS NOT NULL GROUP BY p.一级机构, p.职位 ORDER BY avg_years_of_service DESC;"}
{"difficulty": "简单", "question": "请问今年（假设是T128年）Q4季度，我公司有多少编制空缺需要填补？", "answer": "SELECT SUM(CAST(季度可申请空缺数量 AS INTEGER)) AS 总季度编制空缺 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = '[财年]' AND 编制月度 IN ([季度]);"}
{"difficulty": "困难", "question": "请列出目前我公司管理层（假设为职务名称包含'经理'或'总监'）中，拥有硕士及以上学历的员工列表。", "answer": "SELECT p.姓名, p.职务名称, e.学历 FROM public.a_sap_personnel_basic_information_ai_chinese_real p JOIN public.a_sap_employee_education_information_ai_chinese_real e ON p.人员编号 = e.人员工号 WHERE (p.职务名称 LIKE '%经理%' OR p.职务名称 LIKE '%总监%' OR p.职务名称 LIKE '%主任%') AND e.学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "简单", "question": "请问今年（T127）的编制空缺情况是多少？", "answer": "SELECT 编制年度, SUM(有效编制空缺) AS 空缺总数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = '[财年]' GROUP BY 编制年度;"}
{"difficulty": "简单", "question": "目前本公司有哪些不同的学历层次的员工？", "answer": "SELECT DISTINCT 学历 FROM public.a_sap_employee_education_information_ai_chinese_real;"}
{"difficulty": "中等", "question": "我们需要查看所有一级机构下，每个职位的岗位对公司的风险点有哪些，该如何查询？", "answer": "SELECT 一级机构, 职位, 岗位风险点 FROM public.a_sap_position_information_synchronization_ai_chinese_real;"}
{"difficulty": "简单", "question": "请问目前公司总体的员工数量是多少？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职 ';"}
{"difficulty": "困难", "question": "今年是T127，7月份，请问最近一个季度中，各一级机构的招聘编制使用率是如何？需要考虑有效编制空缺和拟在职人数。", "answer": "SELECT 一级机构, SUM(CASE WHEN 编制月度 IN ('4','5','6') THEN CAST(年度编制数量 AS INTEGER) END) AS 一季度编制数量, SUM(CASE WHEN 编制月度 IN ('4','5','6') THEN 有效编制空缺 END) AS 一季度有效空缺, SUM(CASE WHEN 编制月度 IN ('4','5','6') THEN CAST(拟在职人数 AS INTEGER) END) AS 一季度拟在职人数, (SUM(CASE WHEN 编制月度 IN ('4','5','6') THEN CAST(年度编制数量 AS INTEGER) - 有效编制空缺 END) / SUM(CASE WHEN 编制月度 IN ('4','5','6') THEN CAST(年度编制数量 AS INTEGER) END)::float) * 100 AS 使用率 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = '[财年]' GROUP BY 一级机构;"}
{"difficulty": "简单", "question": "请列出目前所有员工的姓名和对应的职位。", "answer": "SELECT 姓名, 职位 FROM public.a_sap_personnel_basic_information_ai_chinese_real;"}
{"difficulty": "简单", "question": "我们想知道当前有多少个职位是空缺的，即有效编制空缺大于0的职位。", "answer": "SELECT COUNT(*) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 有效编制空缺 > 0;"}
{"difficulty": "中等", "question": "我们需要找出在职状态为'在职'且最高学历为'博士'的员工名单。", "answer": "SELECT a.姓名 FROM public.a_sap_personnel_basic_information_ai_chinese_real a JOIN public.a_sap_employee_education_information_ai_chinese_real b ON a.人员编号 = b.人员工号 WHERE a.雇佣状态 = '在职' AND b.学历 = '博士';"}
{"difficulty": "简单", "question": "目前公司拥有的员工总数，以及其中在职和离职的员工人数分别是多少？", "answer": "SELECT SUM(case when 雇佣状态 = '在职' then 1 else 0 end) 在职员工数, SUM(case when 雇佣状态 = '离职' then 1 else 0 end) 离职员工数 FROM public.a_sap_personnel_basic_information_ai_chinese_real;"}
{"difficulty": "中等", "question": "公司今年T127,5月的编制空缺情况如何？请列出本月的有效编制空缺数以及月度可申请空缺数量。", "answer": "SELECT 编制月度, 有效编制空缺, 月度可申请空缺数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = 'T128' AND 编制月度 = '[月份]';"}
{"difficulty": "困难", "question": "分析员工教育水平及部门分布情况。每个部门的平均学历水平是什么？请返回部门和平均学历水平。", "answer": "SELECT p.一级机构名称, AVG(CASE WHEN e.学历 = '博士' THEN 4 WHEN e.学历 = '硕士' THEN 3 WHEN e.学历 = '大学本科' THEN 2 WHEN e.学历 = '大专' THEN 1 ELSE 0 END) AS 平均学历水平 FROM public.a_sap_employee_education_information_ai_chinese_real e JOIN public.a_sap_personnel_basic_information_ai_chinese_real p ON e.人员工号 = p.人员编号 GROUP BY p.一级机构名称;"}
{"difficulty": "简单", "question": "目前公司总共有多少空缺职位？", "answer": "SELECT SUM(CAST(有效编制空缺 AS INTEGER)) AS 总空缺职位数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real;"}
{"difficulty": "中等", "question": "当前具有硕士及以上学历的员工总数是多少？", "answer": "SELECT COUNT(DISTINCT 人员工号) AS 硕士及以上学历员工总数 FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历 IN ('硕士', '博士', '博士后');"}
{"difficulty": "困难", "question": "公司哪个一级机构的管理岗位空缺率最高，并列出该机构的管理岗位空缺数和总编制数？", "answer": "WITH 编制情况 AS (SELECT 一级机构, SUM(CAST(有效编制空缺 AS INTEGER)) AS 空缺数, SUM(CAST(年度编制数量 AS INTEGER)) AS 总编制数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real GROUP BY 一级机构), 管理岗位 AS (SELECT 一级机构, SUM(CASE WHEN 职位 LIKE '%管理%' THEN 1 ELSE 0 END) AS 管理岗位空缺数, COUNT(职位) AS 管理岗位总数 FROM public.a_sap_position_information_synchronization_ai_chinese_real WHERE 职位 LIKE '%管理%' GROUP BY 一级机构) SELECT 管理岗位.一级机构, 管理岗位空缺数, 管理岗位总数 FROM 编制情况 INNER JOIN 管理岗位 ON 编制情况.一级机构 = 管理岗位.一级机构 ORDER BY (管理岗位空缺数::FLOAT / 总编制数) DESC LIMIT 1;"}
{"difficulty": "简单", "question": "我们想知道目前公司总共有多少雇员处于正式雇佣状态。", "answer": "SELECT COUNT(*) as Total_Employees FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "简单", "question": "请问2023年Q3有多少有效编制空缺？", "answer": "SELECT SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度='[财年]' AND 编制月度 IN ([季度]);"}
{"difficulty": "中等", "question": "在所有教育信息中，有多少人持有大学本科学历，并且在2021年以前入职的？", "answer": "SELECT COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real WHERE 学历='[学历]' AND EXISTS (SELECT 1 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE public.a_sap_employee_education_information_ai_chinese_real.人员工号=public.a_sap_personnel_basic_information_ai_chinese_real.人员编号 AND 入职日期 < '2021-01-01');"}
{"difficulty": "中等", "question": "目前在职的员工中，有多少人属于技术员或资深技术员职务？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 职位 LIKE '%技术员%' AND 雇佣状态='在职';"}
{"difficulty": "困难", "question": "哪个一级机构在T128年度内增加了最多的特批编制数量？", "answer": "SELECT 一级机构, SUM(CAST(特批编制数量 AS INTEGER)) AS 总特批编制数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度='[财年]' GROUP BY 一级机构 ORDER BY 总特批编制数量 DESC LIMIT 1;"}
{"difficulty": "困难", "question": "请列出持有本科学历或以上且目前担任总监职务的员工姓名及职务名称。", "answer": "SELECT DISTINCT b.姓名, b.职务名称 FROM public.a_sap_employee_education_information_ai_chinese_real a JOIN public.a_sap_personnel_basic_information_ai_chinese_real b ON a.人员工号 = b.人员编号 WHERE (a.学历='大学本科' OR a.学历='硕士'  OR a.学历='博士') AND b.雇佣状态='在职' AND b.职务名称 LIKE '%总监%';"}
{"difficulty": "简单", "question": "在2022年Q1，公司有多少有效编制空缺？", "answer": "SELECT SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = '[年份]' AND 编制月度 IN ([季度])"}
{"difficulty": "中等", "question": "目前在职的资深技术员有多少人？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 职位 LIKE '%资深技术员%' AND 雇佣状态 = '在职'"}
{"difficulty": "困难", "question": "请列出目前所有一级机构的名称以及下属的总监职位的人员姓名。", "answer": "SELECT p.一级机构名称, r.姓名 FROM public.a_sap_personnel_basic_information_ai_chinese_real p JOIN public.a_sap_reporting_relationship_ai_chinese_real r ON p.人员编号 = r.人员号 WHERE r.职务名称 LIKE '%总监%' GROUP BY p.一级机构名称, r.姓名"}
{"difficulty": "中等", "question": "截至目前，公司一级机构下有多少个不同的职务？", "answer": "SELECT COUNT(DISTINCT 职务) FROM public.a_sap_position_information_synchronization_ai_chinese_real WHERE 一级机构 IS NOT NULL"}
{"difficulty": "困难", "question": "请列出所有员工的姓名和对应的直属上司姓名，并按照部门分类。", "answer": "SELECT p.姓名 AS 员工姓名, r.主管1姓名 AS 直属上司姓名, p.一级机构名称 AS 部门 FROM public.a_sap_personnel_basic_information_ai_chinese_real p JOIN public.a_sap_reporting_relationship_ai_chinese_real r ON p.人员编号 = r.人员号 ORDER BY p.一级机构名称"}
{"difficulty": "中等", "question": "截至当前最新数据，HR部门中担任经理职务（含资深经理）的员工有多少人？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 一级机构名称 = 'HR' AND 职务名称 like '%经理%' or  职务名称 like '%主任%' ;"}
{"difficulty": "困难", "question": "报告关系表中，哪位总监在管理的员工数量最多，包括直接和间接下属，并列出这位总监的姓名和总监的人员号。", "answer": "WITH Subordinates AS (SELECT 总监1姓名, 总监1职务, COUNT(*) AS 下属数量 FROM public.a_sap_reporting_relationship_ai_chinese_real GROUP BY 总监1姓名, 总监1职务) SELECT s.总监1姓名, s.总监1职务, max(s.下属数量) AS 最多管理的员工数量 FROM Subordinates s GROUP BY s.总监1姓名, s.总监1职务 ORDER BY 最多管理的员工数量 DESC LIMIT 1;"}
{"difficulty": "困难", "question": "提供一个报告，显示所有在T127年内入职的员工，他们的姓名、入职日期和部门，按入职日期升序排序。", "answer": "SELECT 姓名, 入职日期, 一级机构名称 AS 部门 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE EXTRACT(YEAR FROM TO_DATE(入职日期, 'YYYY-MM-DD')) = [年份] ORDER BY 入职日期 ASC;"}
{"difficulty": "中等", "question": "请找出2022年Q2期间入职，并且是硕士学历的员工名单。", "answer": "SELECT pbi.姓名 FROM public.a_sap_personnel_basic_information_ai_chinese_real pbi JOIN public.a_sap_employee_education_information_ai_chinese_real eei ON pbi.人员编号 = eei.人员工号 WHERE eei.学历 = '[学历]' AND pbi.入职日期 BETWEEN '2023-07-01' AND '2023-09-30';"}
{"difficulty": "中等", "question": "当前有多少个职位在AI二级机构下空缺，并需要招聘的人数。", "answer": "SELECT COUNT(*) AS 空缺职位数量, SUM(CAST(有效编制空缺 AS INTEGER)) AS 总招聘人数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 二级机构 = 'AI' AND 有效编制空缺 > 0;"}
{"difficulty": "困难", "question": "统计目前公司每个一级机构下各个职务的人数分布情况。", "answer": "SELECT 一级机构名称, 职务名称, COUNT(*) AS 人数 FROM public.a_sap_personnel_basic_information_ai_chinese_real GROUP BY 一级机构名称, 职务名称 ORDER BY 一级机构名称, 职务名称;"}
{"difficulty": "困难", "question": "找出所有在CPD一级机构工作，且直属上司职务为'总监'级别的员工信息。", "answer": "SELECT pbi.姓名, pbi.直属上司姓名, pbi.直属上司工号 FROM public.a_sap_personnel_basic_information_ai_chinese_real pbi JOIN public.a_sap_reporting_relationship_ai_chinese_real rrp ON pbi.直属上司工号 = rrp.人员号 WHERE pbi.一级机构名称 = '[部门]' AND rrp.职务名称 LIKE '%总监%';"}
{"difficulty": "简单", "question": "请问T127年度一共有多少有效的编制空缺？", "answer": "SELECT SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = 'T127';"}
{"difficulty": "中等", "question": "目前哪些员工的学历为硕士，并且其所在的一级机构为FE？", "answer": "SELECT a.人员工号, a.姓名, a.学历, b.一级机构名称 FROM public.a_sap_employee_education_information_ai_chinese_real AS a JOIN public.a_sap_personnel_basic_information_ai_chinese_real AS b ON a.人员工号 = b.人员编号 WHERE a.学历 = '[学历]' AND b.一级机构名称 = '[部门]';"}
{"difficulty": "中等", "question": "当前在QA部门任职经理职务的员工有谁？", "answer": "SELECT 人员编号, 姓名, 职务名称 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 一级机构名称 = '[部门]' AND 职务名称 like '%经理%' or  职务名称 like '%主任%' ;"}
{"difficulty": "困难", "question": "请列出目前所有一级机构下，具有本科学历且职位为技术员的员工列表。", "answer": "SELECT b.人员编号, b.姓名, b.一级机构名称, b.职位 FROM public.a_sap_employee_education_information_ai_chinese_real AS a JOIN public.a_sap_personnel_basic_information_ai_chinese_real AS b ON a.人员工号 = b.人员编号 WHERE a.学历 = '大学本科' AND b.职位 LIKE '%技术员%';"}
{"difficulty": "简单", "question": "请问当前一共有多少在职员工？", "answer": "SELECT COUNT(*) FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职';"}
{"difficulty": "中等", "question": "目前AI二级机构下有多少有效编制空缺，以及这些空缺的年度编制数量是多少？", "answer": "SELECT SUM(有效编制空缺) as 总空缺数, SUM(CAST(年度编制数量 AS INTEGER)) as 年度编制总数 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 二级机构 = '[二级机构]';"}
{"difficulty": "困难", "question": "我们需不需要增加资深技术员的编制？如果需要，现有编制空缺数与拟在职人数之间差了多少人？", "answer": "SELECT (CAST(拟在职人数 AS INTEGER) - SUM(有效编制空缺)) as 编制差 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 员工子组 = 'A2' GROUP BY 拟在职人数;"}
{"difficulty": "简单", "question": "请问在2023年第一季度有多少有效的编制空缺？", "answer": "SELECT SUM(有效编制空缺) FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度='T128' AND 编制月度 IN ('3','4','5');"}
{"difficulty": "中等", "question": "当前在职的员工中，有多少人的最高学历是博士？", "answer": "SELECT COUNT(*) FROM public.a_sap_employee_education_information_ai_chinese_real AS edu INNER JOIN public.a_sap_personnel_basic_information_ai_chinese_real AS base ON edu.人员工号 = base.人员编号 WHERE base.雇佣状态='在职' AND edu.学历='[学历]';"}
{"difficulty": "困难", "question": "请列出所有一级机构中哪些部门的职务范围包含'经理'级别以上的岗位，并按照一级机构名称排序。", "answer": "SELECT DISTINCT 一级机构, 职务 FROM public.a_sap_position_information_synchronization_ai_chinese_real WHERE 职务 like '%经理%' or 职务 like '%总监%' or 职务 like '%总裁%' or 职务 like '%董事%' ORDER BY 一级机构;"}
{"difficulty": "简单", "question": "请查询当前在职的所有'二级员工'的姓名和人员编号。", "answer": "SELECT 姓名, 人员编号 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 雇佣状态 = '在职' AND 员工子组文本 LIKE '%二级员工%';"}
{"difficulty": "中等", "question": "对于T128财年，查询在'AD'二级机构中，编制月度为'3'月，员工子组为'技术员'的有效编制空缺数。", "answer": "SELECT 有效编制空缺 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度='[财年]' AND 编制月度='[月份]' AND 员工子组='技术员' AND 二级机构='[二级机构]';"}
{"difficulty": "困难", "question": "请查询所有在APD部门任职'经理'级别且拥有硕士学历的员工的姓名、职务名称和入职日期。", "answer": "SELECT info.姓名, info.职务名称, info.入职日期 FROM public.a_sap_personnel_basic_information_ai_chinese_real as info JOIN public.a_sap_employee_education_information_ai_chinese_real as edu ON info.人员编号 = edu.人员工号 WHERE info.一级机构名称='[部门]' AND edu.学历='硕士' AND (info.职务名称 LIKE '%经理%' OR info.职务名称 LIKE '%主任%');"}
{"difficulty": "中等", "question": "查询'技术员'这一员工子组中个人的最新入职日期。", "answer": "SELECT 姓名, MAX(入职日期) as 最新入职日期 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 职位 LIKE '%技术员%' GROUP BY 姓名;"}
{"difficulty": "简单", "question": "查找目前所有'总监'级别的员工姓名、部门和职位。", "answer": "SELECT 姓名, 一级机构名称 as 部门, 职位 FROM public.a_sap_personnel_basic_information_ai_chinese_real WHERE 职务名称 LIKE '%总监%';"}
{"difficulty": "简单", "question": "目前2023年3月份，职务为经理级别的员工中，空缺编制数量是多少？", "answer": "SELECT SUM(有效编制空缺) AS 空缺编制数量 FROM public.a_sap_et_zthr_zp_list_ai_chinese_real WHERE 编制年度 = 'T128' AND 编制月度 = '3' AND 职级范围 ='JG7-10';"}
{"difficulty": "困难", "question": "需要生成一份报告，列出所有三级机构，以及每个三级机构下拥有的职务类型总数。", "answer": "SELECT 三级机构, COUNT(DISTINCT 职务类型) AS 职务类型总数 FROM public.a_sap_position_information_synchronization_ai_chinese_real GROUP BY 三级机构;"}
{"difficulty": "困难", "question": "IDT部门的在职员工，博士学历在T128年的绩效如何？", "answer": "SELECT\n  p.绩效\nFROM\n  a_sap_performance_ai p\n  INNER JOIN a_sap_employee_information_chinese e ON p.人员工号 = e.人员工号\n  INNER JOIN a_sap_employee_education_experience_chinese ed ON e.人员工号 = ed.人员工号\nWHERE\n  e.一级机构名称 = 'IDT'\n  AND e.雇佣状态 = '在职'\n  AND ed.学历 = '博士'\n  AND p.编制年度 = 'T128'\nLIMIT\n  50"}
{"difficulty": "中等", "question": "罗文洲在T128是什么绩效，又是什么学历？", "answer": "SELECT\n  p.绩效,\n  e.学历\nFROM\n  a_sap_performance_ai p\n  LEFT JOIN (\n    SELECT\n      人员工号,\n      学历,\n      ROW_NUMBER() OVER (\n        PARTITION BY\n          人员工号\n        ORDER BY\n          结束日期 DESC\n      ) AS rn\n    FROM\n      a_sap_employee_education_experience_chinese\n  ) e ON p.人员工号 = e.人员工号\n  AND e.rn = 1\nWHERE\n  p.编制年度 = 'T128'\n  AND p.姓名 = '罗文洲'\nLIMIT\n  50;"}
{"difficulty": "中等", "question": "IDT部门的工程师在T128年和T129年的绩效如何？", "answer": "SELECT\n  a_sap_performance_ai.姓名,\n  a_sap_performance_ai.人员工号,\n  a_sap_performance_ai.编制年度,\n  a_sap_performance_ai.绩效\nFROM\n  a_sap_performance_ai\n  INNER JOIN a_sap_employee_information_chinese ON a_sap_performance_ai.人员工号 = a_sap_employee_information_chinese.人员工号\nWHERE\n  a_sap_employee_information_chinese.职务名称 LIKE '%工程师%'\n  AND a_sap_employee_information_chinese.一级机构名称 = 'IDT'\n  AND a_sap_performance_ai.编制年度 IN ('T128')\nLIMIT\n  50"}
{"difficulty": "中等", "question": "IDT部门的在职工程师在T128年和T129年的绩效如何？", "answer": "SELECT\n  p.编制年度,\n  p.姓名,\n  p.人员工号,\n  p.绩效\nFROM\n  a_sap_performance_ai p\n  INNER JOIN a_sap_employee_information_chinese e ON p.人员工号 = e.人员工号\nWHERE\n  e.一级机构名称 = 'IDT'\n  AND e.雇佣状态 = '在职'\n  AND e.职务名称 LIKE '%工程师%'\n  AND p.编制年度 IN ('T128')\nLIMIT\n  50"}
