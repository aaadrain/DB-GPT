首先，我们需要确定最近一周的日期范围，从当前日期2024-03-25往前推7天，即从2024-03-18到2024-03-25。接下来，我们需要从表a_sap_plus_attx_ccd_data_chinese中筛选出这个时间范围内的数据。根据背景知识，'设备坐标Sxx-x对应拉线规则'，我们可以通过设备坐标来确定是哪一拉的设备。我们需要计算每个设备的NG率，即NG数量除以总检测数量。然后，我们将按NG率降序排列，并限制结果为最多50个。我们将使用'设备坐标'列来确定拉线，'时间'列来筛选日期范围，'检测结果'列来计算NG率。\n<chart-view content="{&quot;type&quot;: &quot;response_table&quot;, &quot;sql&quot;: &quot;SELECT 设备坐标, SUM(CASE WHEN 检测结果 = 'NG' THEN 1 ELSE 0 END)::FLOAT / COUNT(*) AS ng_rate FROM a_sap_plus_attx_ccd_data_chinese WHERE 时间 BETWEEN '2024-03-18' AND '2024-03-25' AND (设备坐标 LIKE 'S01-%' OR 设备坐标 LIKE 'S02-%' OR 设备坐标 LIKE 'S03-%' OR 设备坐标 LIKE 'S04-%') GROUP BY 设备坐标 ORDER BY ng_rate DESC LIMIT 50&quot;, &quot;data&quot;: [{&quot;设备坐标&quot;: &quot;S02-1&quot;, &quot;ng_rate&quot;: 0.0127199265}, {&quot;设备坐标&quot;: &quot;S02-2&quot;, &quot;ng_rate&quot;: 0.0107537237}, {&quot;设备坐标&quot;: &quot;S03-1&quot;, &quot;ng_rate&quot;: 0.0086818145}, {&quot;设备坐标&quot;: &quot;S01-4&quot;, &quot;ng_rate&quot;: 0.0085961825}, {&quot;设备坐标&quot;: &quot;S04-3&quot;, &quot;ng_rate&quot;: 0.0084351753}, {&quot;设备坐标&quot;: &quot;S04-4&quot;, &quot;ng_rate&quot;: 0.0079332751}, {&quot;设备坐标&quot;: &quot;S03-4&quot;, &quot;ng_rate&quot;: 0.0072090628}, {&quot;设备坐标&quot;: &quot;S04-1&quot;, &quot;ng_rate&quot;: 0.0032256833}, {&quot;设备坐标&quot;: &quot;S01-1&quot;, &quot;ng_rate&quot;: 0.0031801395}, {&quot;设备坐标&quot;: &quot;S02-3&quot;, &quot;ng_rate&quot;: 0.0030399537}, {&quot;设备坐标&quot;: &quot;S02-4&quot;, &quot;ng_rate&quot;: 0.0027812692}, {&quot;设备坐标&quot;: &quot;S01-3&quot;, &quot;ng_rate&quot;: 0.002237859}, {&quot;设备坐标&quot;: &quot;S04-2&quot;, &quot;ng_rate&quot;: 0.0017167683}, {&quot;设备坐标&quot;: &quot;S03-2&quot;, &quot;ng_rate&quot;: 0.0004521418}]}" />